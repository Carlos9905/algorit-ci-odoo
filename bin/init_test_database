#!/bin/bash
set -e

# Script para inicializar base de datos de prueba

echo "=== Inicializando base de datos ${PGDATABASE} ==="

# Esperar PostgreSQL
wait_for_postgres

# Crear base de datos si no existe
if ! psql -h ${PGHOST} -U ${PGUSER} -lqt | cut -d \| -f 1 | grep -qw ${PGDATABASE}; then
    echo "Creando base de datos ${PGDATABASE}..."
    createdb -h ${PGHOST} -U ${PGUSER} ${PGDATABASE}
else
    echo "Base de datos ${PGDATABASE} ya existe"
fi

echo "=== Base de datos inicializada ==="
